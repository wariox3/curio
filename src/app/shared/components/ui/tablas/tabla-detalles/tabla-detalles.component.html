<div [class]="clasesContenedor">
  <!-- Mensaje cuando no hay datos -->
  <div *ngIf="!hayDatos" class="p-6 text-center text-gray-500">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-12 w-12 mx-auto mb-2 text-gray-300"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="1"
        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
      />
    </svg>
    <p>{{ textoVacio }}</p>
  </div>

  <!-- Tabla de detalles -->
  <table *ngIf="hayDatos" class="w-full text-sm">
    <tbody>
      <!-- Campos normales (en pares o individuales según configuración) -->
      <ng-container *ngFor="let campo of campos; let i = index">
        <!-- Campos que ocupan fila completa -->
        <ng-container *ngIf="campo.filaCompleta">
          <tr class="border-b border-gray-200">
            <td [class]="clasesEtiqueta" [style.width]="campo.anchoEtiqueta">
              {{ campo.etiqueta }}
            </td>
            <td
              [attr.colspan]="columnas === 2 ? 1 : columnas === 4 ? 3 : 5"
              class="px-4 py-3 text-gray-800"
              [style.width]="campo.anchoValor"
            >
              {{ obtenerValor(campo) }}
            </td>
          </tr>
        </ng-container>

        <!-- Campos en pares (4 columnas) o tríos (6 columnas) -->
        <ng-container *ngIf="!campo.filaCompleta && (columnas === 4 || columnas === 6)">
          <tr *ngIf="i % camposPorFila === 0" class="border-b border-gray-200">
            <!-- Primera etiqueta-valor -->
            <td
              [class]="clasesEtiqueta"
              [style.width]="campos[i].anchoEtiqueta || (columnas === 4 ? 'w-1/4' : 'w-1/6')"
            >
              {{ campos[i].etiqueta }}
            </td>
            <td
              class="px-4 py-3 text-gray-800 border-r border-gray-200"
              [style.width]="campos[i].anchoValor || (columnas === 4 ? 'w-1/4' : 'w-1/6')"
            >
              {{ obtenerValor(campos[i]) }}
            </td>

            <!-- Segunda etiqueta-valor (si existe) -->
            <ng-container *ngIf="i + 1 < campos.length && !campos[i + 1].filaCompleta">
              <td
                [class]="clasesEtiqueta"
                [style.width]="campos[i + 1].anchoEtiqueta || (columnas === 4 ? 'w-1/4' : 'w-1/6')"
              >
                {{ campos[i + 1].etiqueta }}
              </td>
              <td
                class="px-4 py-3 text-gray-800"
                [ngClass]="{ 'border-r border-gray-200': columnas === 6 }"
                [style.width]="campos[i + 1].anchoValor || (columnas === 4 ? 'w-1/4' : 'w-1/6')"
              >
                {{ obtenerValor(campos[i + 1]) }}
              </td>
            </ng-container>

            <!-- Tercera etiqueta-valor (solo para 6 columnas y si existe) -->
            <ng-container
              *ngIf="columnas === 6 && i + 2 < campos.length && !campos[i + 2].filaCompleta"
            >
              <td [class]="clasesEtiqueta" [style.width]="campos[i + 2].anchoEtiqueta || 'w-1/6'">
                {{ campos[i + 2].etiqueta }}
              </td>
              <td
                class="px-4 py-3 text-gray-800"
                [style.width]="campos[i + 2].anchoValor || 'w-1/6'"
              >
                {{ obtenerValor(campos[i + 2]) }}
              </td>
            </ng-container>

            <!-- Celdas vacías si no hay segundo campo (para 4 columnas) -->
            <ng-container
              *ngIf="columnas === 4 && (i + 1 >= campos.length || campos[i + 1].filaCompleta)"
            >
              <td [class]="clasesEtiqueta + ' opacity-0'">-</td>
              <td class="px-4 py-3 text-gray-800 opacity-0">-</td>
            </ng-container>

            <!-- Celdas vacías si no hay segundo o tercer campo (para 6 columnas) -->
            <ng-container *ngIf="columnas === 6">
              <!-- Si falta el segundo campo -->
              <ng-container *ngIf="i + 1 >= campos.length || campos[i + 1].filaCompleta">
                <td [class]="clasesEtiqueta + ' opacity-0'">-</td>
                <td class="px-4 py-3 text-gray-800 border-r border-gray-200 opacity-0">-</td>
                <td [class]="clasesEtiqueta + ' opacity-0'">-</td>
                <td class="px-4 py-3 text-gray-800 opacity-0">-</td>
              </ng-container>
              <!-- Si hay segundo campo pero falta el tercero -->
              <ng-container
                *ngIf="
                  i + 1 < campos.length &&
                  !campos[i + 1].filaCompleta &&
                  (i + 2 >= campos.length || campos[i + 2].filaCompleta)
                "
              >
                <td [class]="clasesEtiqueta + ' opacity-0'">-</td>
                <td class="px-4 py-3 text-gray-800 opacity-0">-</td>
              </ng-container>
            </ng-container>
          </tr>
        </ng-container>

        <!-- Campos individuales (2 columnas) -->
        <ng-container *ngIf="!campo.filaCompleta && columnas === 2">
          <tr class="border-b border-gray-200">
            <td [class]="clasesEtiqueta" [style.width]="campo.anchoEtiqueta || 'w-1/3'">
              {{ campo.etiqueta }}
            </td>
            <td class="px-4 py-3 text-gray-800" [style.width]="campo.anchoValor || 'w-2/3'">
              {{ obtenerValor(campo) }}
            </td>
          </tr>
        </ng-container>
      </ng-container>
    </tbody>
  </table>
</div>
